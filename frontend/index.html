<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Academic Primer Generator</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <header>
    <div class="header-inner">
      <div class="logo">AP</div>
      <div>
        <h1>Academic Primer Generator</h1>
        <p class="tagline">PhD-level research primers backed by real literature</p>
      </div>
    </div>
  </header>

  <main>

    <!-- ── Input ── -->
    <section class="input-section">
      <form id="primer-form">
        <label for="topic-input">What do you want a primer on?</label>
        <textarea
          id="topic-input"
          rows="3"
          maxlength="500"
          placeholder="e.g. How do transformer attention mechanisms work, and what are their limitations for long-context reasoning?"
        ></textarea>
        <div class="form-footer">
          <span id="char-count" class="char-count">0 / 500</span>
          <button type="submit" id="submit-btn">
            <span class="btn-label">Find Papers</span>
            <svg class="btn-arrow" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
            </svg>
            <span class="spinner hidden" id="btn-spinner" aria-label="Loading"></span>
          </button>
        </div>
      </form>
    </section>

    <!-- ── Status ── -->
    <section id="status-section" class="hidden" aria-live="polite">
      <div class="status-bar">
        <span class="status-dot" aria-hidden="true"></span>
        <span id="status-text"></span>
      </div>
    </section>

    <!-- ── Queries ── -->
    <section id="queries-section" class="card hidden">
      <h3 class="card-label">Search Queries</h3>
      <ul id="queries-list"></ul>
      <div class="meta-row">
        <span class="field-badge" id="field-badge"></span>
        <span id="keywords-text" class="keywords-text"></span>
      </div>
    </section>

    <!-- ── Papers ── -->
    <section id="papers-section" class="hidden">
      <div class="papers-header">
        <h2 class="section-title">
          Papers Found
          <span class="section-count" id="paper-count"></span>
        </h2>
        <span class="papers-hint">Uncheck papers to exclude them from the primer.</span>
      </div>
      <div id="papers-grid"></div>

      <!-- Paper lookup -->
      <div id="paper-lookup" class="paper-lookup hidden">
        <form id="paper-lookup-form" autocomplete="off">
          <div class="paper-lookup-row">
            <input
              id="paper-lookup-input"
              type="text"
              placeholder="3–5 keywords, partial title, or DOI (e.g. 10.1234/…)"
              maxlength="300"
            />
            <button type="submit" id="paper-lookup-btn">
              Search
              <span class="spinner hidden" id="paper-lookup-spinner"></span>
            </button>
          </div>
        </form>
        <div id="paper-lookup-results" class="paper-lookup-results hidden"></div>
      </div>

      <!-- Confirm step -->
      <div id="generate-confirm" class="generate-confirm hidden">
        <span id="selected-count" class="selected-count"></span>
        <button id="generate-btn" type="button" class="generate-btn">
          Generate Primer
          <svg class="btn-arrow" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
          </svg>
          <span class="spinner hidden" id="generate-spinner"></span>
        </button>
      </div>
    </section>

    <!-- ── Primer ── -->
    <section id="primer-section" class="hidden">
      <div class="primer-header">
        <h2 class="section-title">Academic Primer</h2>
        <button id="copy-btn" class="copy-btn hidden" type="button">Copy</button>
      </div>
      <div id="primer-content" class="primer-content" aria-live="polite"></div>
    </section>

    <!-- ── Error ── -->
    <div id="error-box" class="error-box hidden" role="alert">
      <strong>Error:</strong> <span id="error-text"></span>
    </div>

  </main>

  <script src="https://cdn.jsdelivr.net/npm/marked@9/marked.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
